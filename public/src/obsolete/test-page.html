<link rel="import" href="../../bower_components/soso-file-picker/soso-file-picker.html">

<dom-module id="test-page">
  <template>
    <style>
      :host {
        display: block;
      }

      img {
        display: block;
        max-width: 900px;
        height: auto;
        margin: 10px auto;
      }
    </style>
    <soso-file-picker id="fp" label="Drag an image" accept="image/*" on-files="_onFile"></soso-file-picker>
    <img id="img">
  </template>
  <script>
    class TestPage extends Polymer.Element {
      static get is() { return "test-page"; }

      _onFile(event) {
        let file = event.detail.file;
        if (!file) {
          return;
        }
        $core.register().then(() => {
          console.log("uploading...");
          $core.uploadImageFile(file, null, 300).then((data) => {
            console.log(data);
            this.$.img.src = data.url;
          });
        });
      }
    }
    window.customElements.define(TestPage.is, TestPage);
  </script>
</dom-module>