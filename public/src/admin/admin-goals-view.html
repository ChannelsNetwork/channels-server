<dom-module id="admin-goals-view">
  <template>
    <style is="custom-style" include="app-styles">
      :host {
        display: block;
      }

      #container {
        margin: 0 auto;
        padding: 20px 16px;
      }

      .table {
        display: table;
        border-collapse: collapse;
        font-size: 12px;
        margin: 30px 0 50px;
      }

      .headerRow {
        display: table-row;
      }

      .headerCell {
        display: table-cell;
        font-weight: bold;
        border: 1px solid #aaa;
        padding: 3px;
      }

      .row {
        display: table-row;
      }

      .rowHeader1 {
        font-weight: bold;
        height: 50px;
        vertical-align: bottom;
      }

      .rowHeader2 {
        font-weight: bold;
        padding-left: 20px !important;
      }

      .rowHeader3 {
        font-weight: bold;
        padding-left: 40px !important;
      }

      .rowHeader4 {
        font-weight: bold;
        padding-left: 60px !important;
      }

      .cell {
        display: table-cell;
        border: 1px solid #aaa;
        padding: 3px;
        vertical-align: bottom;
      }

      .center {
        text-align: center;
      }

      .right {
        text-align: right;
      }

      .fixed {
        width: 80px;
      }
    </style>
    <div id="container">
      <h1>Channels Metrics</h1>
      <div class="table">
        <div class="headerRow">
          <div class="headerCell"></div>
          <div class="headerCell right fixed">Total</div>
          <div class="headerCell right fixed">Today</div>
          <div class="headerCell right fixed">Yesterday</div>
          <div class="headerCell right fixed">Prior Week</div>
          <div class="headerCell right fixed">Prior Month</div>
        </div>
        <div class="row">
          <div class="cell rowHeader1">users</div>
          <div class="cell right">[[info.users.total]]</div>
          <div class="cell right">[[info.users.newUsers.today]]</div>
          <div class="cell right">[[info.users.newUsers.yesterday]]</div>
          <div class="cell right">[[info.users.newUsers.priorWeek]]</div>
          <div class="cell right">[[info.users.newUsers.priorMonth]]</div>
        </div>
        <div class="row">
          <div class="cell rowHeader2">with identity</div>
          <div class="cell right">[[info.users.totalWithIdentity]]</div>
          <div class="cell right">[[info.users.newUsersWithIdentity.today]]</div>
          <div class="cell right">[[info.users.newUsersWithIdentity.yesterday]]</div>
          <div class="cell right">[[info.users.newUsersWithIdentity.priorWeek]]</div>
          <div class="cell right">[[info.users.newUsersWithIdentity.priorMonth]]</div>
        </div>
        <div class="row">
          <div class="cell rowHeader3">stale</div>
          <div class="cell right">[[info.users.totalStaleWithIdentity]]</div>
          <div class="cell right"></div>
          <div class="cell right"></div>
          <div class="cell right"></div>
          <div class="cell right"></div>
        </div>
        <div class="row">
          <div class="cell rowHeader2">balance liability</div>
          <div class="cell right">[[info.users.excessBalance]]</div>
          <div class="cell right"></div>
          <div class="cell right"></div>
          <div class="cell right"></div>
          <div class="cell right"></div>
        </div>

        <div class="row">
          <div class="cell rowHeader1">active users</div>
          <div class="cell right"></div>
          <div class="cell right">[[info.activeUsers.total.today]]</div>
          <div class="cell right">[[info.activeUsers.total.yesterday]]</div>
          <div class="cell right">[[info.activeUsers.total.priorWeek]]</div>
          <div class="cell right">[[info.activeUsers.total.priorMonth]]</div>
        </div>
        <div class="row">
          <div class="cell rowHeader2">with identity</div>
          <div class="cell right"></div>
          <div class="cell right">[[info.activeUsers.withIdentity.today]]</div>
          <div class="cell right">[[info.activeUsers.withIdentity.yesterday]]</div>
          <div class="cell right">[[info.activeUsers.withIdentity.priorWeek]]</div>
          <div class="cell right">[[info.activeUsers.withIdentity.priorMonth]]</div>
        </div>
        <div class="row">
          <div class="cell rowHeader2">returning</div>
          <div class="cell right"></div>
          <div class="cell right">[[info.activeUsers.returning.today]]</div>
          <div class="cell right">[[info.activeUsers.returning.yesterday]]</div>
          <div class="cell right">[[info.activeUsers.returning.priorWeek]]</div>
          <div class="cell right">[[info.activeUsers.returning.priorMonth]]</div>
        </div>
        <div class="row">
          <div class="cell rowHeader3">with identity</div>
          <div class="cell right"></div>
          <div class="cell right">[[info.activeUsers.returningWithIdentity.today]]</div>
          <div class="cell right">[[info.activeUsers.returningWithIdentity.yesterday]]</div>
          <div class="cell right">[[info.activeUsers.returningWithIdentity.priorWeek]]</div>
          <div class="cell right">[[info.activeUsers.returningWithIdentity.priorMonth]]</div>
        </div>

        <div class="row">
          <div class="cell rowHeader1">cards</div>
          <div class="cell right">[[info.cards.total]]</div>
          <div class="cell right">[[info.cards.newCards.today]]</div>
          <div class="cell right">[[info.cards.newCards.yesterday]]</div>
          <div class="cell right">[[info.cards.newCards.priorWeek]]</div>
          <div class="cell right">[[info.cards.newCards.priorMonth]]</div>
        </div>
        <div class="row">
          <div class="cell rowHeader2">budget</div>
          <div class="cell right">[[info.cards.budget]]</div>
          <div class="cell right"></div>
          <div class="cell right"></div>
          <div class="cell right"></div>
          <div class="cell right"></div>
        </div>
        <div class="row">
          <div class="cell rowHeader2">spent</div>
          <div class="cell right">[[info.cards.spent]]</div>
          <div class="cell right"></div>
          <div class="cell right"></div>
          <div class="cell right"></div>
          <div class="cell right"></div>
        </div>
        <div class="row">
          <div class="cell rowHeader2">revenue</div>
          <div class="cell right">[[info.cards.revenue]]</div>
          <div class="cell right"></div>
          <div class="cell right"></div>
          <div class="cell right"></div>
          <div class="cell right"></div>
        </div>

        <div class="row">
          <div class="cell rowHeader1">purchases</div>
          <div class="cell right">[[info.purchases.total]]</div>
          <div class="cell right">[[info.purchases.newPurchases.today]]</div>
          <div class="cell right">[[info.purchases.newPurchases.yesterday]]</div>
          <div class="cell right">[[info.purchases.newPurchases.priorWeek]]</div>
          <div class="cell right">[[info.purchases.newPurchases.priorMonth]]</div>
        </div>
        <div class="row">
          <div class="cell rowHeader2">revenue</div>
          <div class="cell right">[[info.purchases.totalRevenue]]</div>
          <div class="cell right">[[info.purchases.newRevenue.today]]</div>
          <div class="cell right">[[info.purchases.newRevenue.yesterday]]</div>
          <div class="cell right">[[info.purchases.newRevenue.priorWeek]]</div>
          <div class="cell right">[[info.purchases.newRevenue.priorMonth]]</div>
        </div>
        <div class="row">
          <div class="cell rowHeader3">weighted</div>
          <div class="cell right"></div>
          <div class="cell right">[[info.purchases.newWeightedRevenue.today]]</div>
          <div class="cell right">[[info.purchases.newWeightedRevenue.yesterday]]</div>
          <div class="cell right">[[info.purchases.newWeightedRevenue.priorWeek]]</div>
          <div class="cell right">[[info.purchases.newWeightedRevenue.priorMonth]]</div>
        </div>
        <div class="row">
          <div class="cell rowHeader2">first-time</div>
          <div class="cell right">[[info.purchases.totalFirstTime]]</div>
          <div class="cell right">[[info.purchases.firstTime.today]]</div>
          <div class="cell right">[[info.purchases.firstTime.yesterday]]</div>
          <div class="cell right">[[info.purchases.firstTime.priorWeek]]</div>
          <div class="cell right">[[info.purchases.firstTime.priorMonth]]</div>
        </div>
        <div class="row">
          <div class="cell rowHeader2">fraud</div>
          <div class="cell right">[[info.purchases.totalFraud]]</div>
          <div class="cell right">[[info.purchases.fraud.today]]</div>
          <div class="cell right">[[info.purchases.fraud.yesterday]]</div>
          <div class="cell right">[[info.purchases.fraud.priorWeek]]</div>
          <div class="cell right">[[info.purchases.fraud.priorMonth]]</div>
        </div>
        <div class="row">
          <div class="cell rowHeader2">purchasers</div>
          <div class="cell right"></div>
          <div class="cell right">[[info.purchases.purchasers.today]]</div>
          <div class="cell right">[[info.purchases.purchasers.yesterday]]</div>
          <div class="cell right">[[info.purchases.purchasers.priorWeek]]</div>
          <div class="cell right">[[info.purchases.purchasers.priorMonth]]</div>
        </div>
        <div class="row">
          <div class="cell rowHeader2">sellers</div>
          <div class="cell right"></div>
          <div class="cell right">[[info.purchases.sellers.today]]</div>
          <div class="cell right">[[info.purchases.sellers.yesterday]]</div>
          <div class="cell right">[[info.purchases.sellers.priorWeek]]</div>
          <div class="cell right">[[info.purchases.sellers.priorMonth]]</div>
        </div>

        <div class="row">
          <div class="cell rowHeader1">ad slots</div>
          <div class="cell right">[[info.ads.total]]</div>
          <div class="cell right">[[info.ads.newSlots.today]]</div>
          <div class="cell right">[[info.ads.newSlots.yesterday]]</div>
          <div class="cell right">[[info.ads.newSlots.priorWeek]]</div>
          <div class="cell right">[[info.ads.newSlots.priorMonth]]</div>
        </div>
        <div class="row">
          <div class="cell rowHeader2">revenue</div>
          <div class="cell right">[[info.ads.revenue]]</div>
          <div class="cell right">[[info.ads.newRevenue.today]]</div>
          <div class="cell right">[[info.ads.newRevenue.yesterday]]</div>
          <div class="cell right">[[info.ads.newRevenue.priorWeek]]</div>
          <div class="cell right">[[info.ads.newRevenue.priorMonth]]</div>
        </div>
        <div class="row">
          <div class="cell rowHeader2">consumers</div>
          <div class="cell right"></div>
          <div class="cell right">[[info.ads.consumers.today]]</div>
          <div class="cell right">[[info.ads.consumers.yesterday]]</div>
          <div class="cell right">[[info.ads.consumers.priorWeek]]</div>
          <div class="cell right">[[info.ads.consumers.priorMonth]]</div>
        </div>
        <div class="row">
          <div class="cell rowHeader2">advertisers</div>
          <div class="cell right"></div>
          <div class="cell right">[[info.ads.advertisers.today]]</div>
          <div class="cell right">[[info.ads.advertisers.yesterday]]</div>
          <div class="cell right">[[info.ads.advertisers.priorWeek]]</div>
          <div class="cell right">[[info.ads.advertisers.priorMonth]]</div>
        </div>
      </div>
    </div>
  </template>
  <script>
    class AdminGoalsView extends Polymer.Element {
      static get is() { return 'admin-goals-view'; }
      static get properties() {
        return {
          info: Object
        };
      }

      onActivate() {
        $core.register().then((info) => {
          if (!$core.profile || !$core.profile.handle || !info.admin) {
            setTimeout(() => {
              $router.goto("");
              return;
            }, 600);
            return;
          }
          this._refresh();
        }).catch((err) => {
          console.error(err);
          setTimeout(() => {
            $router.goto("");
          }, 600);
        });
      }

      _refresh() {
        this.set('info', {});
        $core.admin_getGoals().then((response) => {
          this.set('info', response);
        });
      }
    }
    window.customElements.define(AdminGoalsView.is, AdminGoalsView);
  </script>
</dom-module>